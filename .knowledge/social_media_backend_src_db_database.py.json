{"is_source_file": true, "format": "Python", "description": "This file contains code for managing a social media application's database using SQLite. It includes functions for setting up database schema, fetching data, and handling database connections, specifically for tables like users, profiles, posts, and followers.", "external_files": ["os", "sqlite3"], "external_methods": ["os.getenv", "os.path.dirname", "os.path.exists", "os.makedirs", "sqlite3.connect"], "published": ["get_db_path", "init_db", "get_db", "fetch_one_dict", "fetch_all_dicts", "paginate_query"], "classes": [], "methods": [{"name": "_ensure_data_dir(path: str)", "description": "Ensures that the directory for the database file exists, creating it if necessary.", "scope": "", "scopeKind": ""}, {"name": "str get_db_path()", "description": "Retrieves the database file path from environment variable or default.", "scope": "", "scopeKind": ""}, {"name": "init_db()", "description": "Initializes the database schema with tables for users, profiles, posts, and followers if they do not exist.", "scope": "", "scopeKind": ""}, {"name": "get_db()", "description": "Provides a context manager for acquiring a SQLite connection with row factory set for dictionary-like row access.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict[str,Any]] fetch_one_dict(cursor)", "description": "Fetches a single row from cursor as a dictionary, or returns None.", "scope": "", "scopeKind": ""}, {"name": "List[Dict[str,Any]] fetch_all_dicts(cursor)", "description": "Fetches all rows from cursor as a list of dictionaries.", "scope": "", "scopeKind": ""}, {"name": "Tuple[str,Tuple[Any,...]] paginate_query(base_sql: str, params: Tuple[Any, ...], page: int, page_size: int)", "description": "Constructs a paginated SQL query with LIMIT and OFFSET.", "scope": "", "scopeKind": ""}], "calls": ["os.getenv", "os.path.dirname", "os.path.exists", "os.makedirs", "sqlite3.connect"], "search-terms": ["database schema", "SQLite setup", "social media database", "user profiles", "follower relationship", "pagination"], "state": 2, "file_id": 5, "knowledge_revision": 35, "git_revision": "", "revision_history": [{"24": ""}, {"35": ""}], "ctags": [{"_type": "tag", "name": "DB_PATH_ENV", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^DB_PATH_ENV = \"SQLITE_DB\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DEFAULT_DB_PATH", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^DEFAULT_DB_PATH = \"data\\/social_media.db\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_ensure_data_dir", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^def _ensure_data_dir(path: str):$/", "language": "Python", "kind": "function", "signature": "(path: str)"}, {"_type": "tag", "name": "fetch_all_dicts", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^def fetch_all_dicts(cursor) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "function", "signature": "(cursor)"}, {"_type": "tag", "name": "fetch_one_dict", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^def fetch_one_dict(cursor) -> Optional[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:Optional[Dict[str,Any]]", "kind": "function", "signature": "(cursor)"}, {"_type": "tag", "name": "get_db", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^def get_db():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_db_path", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^def get_db_path() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "init_db", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^def init_db():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "paginate_query", "path": "/tmp/kavia/workspace/code-generation/user-approval-system-759-769/social_media_backend/src/db/database.py", "pattern": "/^def paginate_query(base_sql: str, params: Tuple[Any, ...], page: int, page_size: int) -> Tuple[s/", "language": "Python", "typeref": "typename:Tuple[str,Tuple[Any,...]]", "kind": "function", "signature": "(base_sql: str, params: Tuple[Any, ...], page: int, page_size: int)"}], "hash": "a364a7f3cad322a22f492bca9fd0f533", "format-version": 4, "code-base-name": "social_media_backend", "filename": "social_media_backend/src/db/database.py", "fields": [{"name": "DB_PATH_ENV = \"SQLITE_DB\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DEFAULT_DB_PATH = \"data\\/social_media.db\"", "scope": "", "scopeKind": "", "description": "unavailable"}]}